{
    "collab_server" : "",
    "contents" : "## app.R ##\nlibrary(shiny)\nlibrary(DT)\nlibrary(shinydashboard)\nlibrary(caret)\nlibrary(rbokeh)\nlibrary(fBasics)\n\nsource(\"visualizations.R\")\n\noptions(shiny.maxRequestSize = 9*1024^2)\n\nui <- dashboardPage(\n  dashboardHeader(title=\"Basic Dashboard\"),\n  \n  dashboardSidebar(\n    sidebarMenu(\n      fileInput('file1', 'Choose file to upload',\n                accept = c(\n                  'text/csv',\n                  'text/comma-separated-values',\n                  'text/tab-separated-values',\n                  'text/plain',\n                  '.csv',\n                  '.tsv')),\n      menuItem(\"DataTable\", tabName = \"datatable\", icon = icon(\"table\")),\n      menuItem(\"Summary Statistics\", tabName = \"summaryStatsItem\", icon = icon(\"table\")),\n      menuItem(\"Dashboard\", tabName = \"dashboard\", icon = icon(\"bar-chart\")),\n      menuItem(\"Dimensionality Reduction\", tabName = \"dimRed\", icon = icon(\"chevron-down\")),\n      menuItem(\"Preprocessing\", tabName = \"preProc\", icon = icon(\"list\")),\n      uiOutput(\"singleSelect\"),\n      uiOutput(\"multiSelect\"),\n      uiOutput(\"classLabelSelect\")\n    )\n  ),\n  \n  dashboardBody(\n    tabItems(\n      # First tab content\n      tabItem(tabName = \"datatable\",\n              fluidRow(\n                box(DT::dataTableOutput(\"dataTable\"))                \n              )\n      ),\n      tabItem(tabName = \"summaryStatsItem\",\n              fluidRow(\n                box(DT::dataTableOutput(\"summaryStats\"))                \n              )\n      ),\n      tabItem(tabName = \"dashboard\",\n              fluidRow(\n                box(plotOutput(\"qqPlot\")),\n                box(plotOutput(\"skewnessPlot\"))\n              )\n      ),\n      tabItem(tabName = \"dimRed\",\n              fluidRow(\n                box(selectInput(\"dimRedSelect\", \"Dimensionality Reduction Technique\", \n                                choices=c(\"PCA\", \"ICA\", \"t-SNE\"), selected=c(\"PCA\")),\n                    actionButton(\"computeDimRedBtn\", \"Compute\"))),\n              fluidRow(\n                rbokehOutput(\"dimRedPlot\")\n              )\n      ),\n      tabItem(tabName = \"preProc\",\n              fluidRow(\n                box(\n                  selectizeInput(\n                    'preProcessing', 'Preprocessing Options',\n                    choices = c(\"BoxCox\", \"YeoJohnson\",\n                                \"expoTrans\", \"center\",\n                                \"scale\", \"spatialSign\",\n                                \"range\"),\n                    selected = c(\"center\", \"scale\"),\n                    multiple = TRUE),\n                  actionButton(\"preProcessBtn\", \"PreProcess\")\n                ),\n                fluidRow(\n                  verbatimTextOutput(\"preProcMsg\")\n                )\n              )\n      )\n    )\n  )\n)\n      \n\nserver <- function(input, output) {\n  \n  inputData <- reactive({\n    inFile <- input$file1\n    \n    if (is.null(inFile))\n      return(NULL)\n    \n    read.csv(inFile$datapath, header = TRUE, \n             sep = \",\", \n             stringsAsFactors = T)\n  })\n  \n  selectedSingleFeature <- reactive({\n    input$singleFeature\n  })\n  \n  selectedClassLabel <- reactive({\n    input$classLabel\n  })\n  \n  selectedMultiFeatures <- reactive({\n    input$multiFeature\n  })\n  \n  output$skewnessPlot <- renderPlot({\n    selected <- selectedMultiFeatures()\n    \n    if (is.null(selected))\n      return(NULL)\n    \n    data <- inputData()[, selected]\n    print(plotSkewness(data))\n  })\n  \n  output$qqPlot <- renderPlot({\n    selected <- selectedSingleFeature()\n    \n    if (is.null(selected))\n      return(NULL)\n    \n    data <- inputData()\n    print(qqPlot(data[, selected]))\n  })\n  \n  output$dimRedPlot <- renderRbokeh({\n    input$computeDimRedBtn\n    selected   <- isolate(selectedMultiFeatures())\n    classLabel <- isolate(selectedClassLabel())\n      \n    if (is.null(selected))\n      return(NULL)\n      \n    data <- inputData()[, c(selected, classLabel)]\n\n    if (input$dimRedSelect == \"PCA\") {\n      return(pcaPlot(data, classLabel))\n    }\n      \n    if (input$dimRedSelect == \"ICA\") {\n      return(icaPlot(data, classLabel))\n    }\n    \n    if (input$dimRedSelect == \"t-SNE\") {\n      return(tsnePlot(data, classLabel))\n    }\n  })\n  \n  output$dataTable <- DT::renderDataTable({\n    selected   <- selectedMultiFeatures()\n    print(paste(\"Selected Data Table: \", selected))\n    print(length(selected))\n    \n    if (is.null(selected))\n      return(NULL)\n    \n    data <- inputData()[, selected]\n    data\n  }, options = list(pageLength = 25))\n  \n  output$summaryStats <- DT::renderDataTable({\n    selected   <- selectedMultiFeatures()\n    print(paste(\"Selected Summary Stats: \", selected))\n    print(length(selected))\n    \n    if (is.null(selected))\n      return(NULL)\n    \n    data <- inputData()[, selected]\n    basicStats(data)\n  }, options = list(pageLength = 16))\n  \n  output$singleSelect <- renderUI({\n    selectInput(\"singleFeature\", \"Choose a Feature:\", \n                choices = colnames(inputData()))\n  })\n  \n  output$multiSelect <- renderUI({\n    selectizeInput(\n      'multiFeature', 'Select Features to Visualize:',\n      choices = colnames(inputData()),\n      selected = colnames(inputData())[1],\n      multiple = TRUE)\n  })\n  \n  output$classLabelSelect <- renderUI({\n    selectInput(\"classLabel\", \"Choose a Class Label:\", \n                choices = colnames(inputData()))\n  })\n  \n  preProcessEventMsg <- eventReactive(input$preProcessBtn, {\n    preProc       <- preProcess(inputData(), method=input$preProcessing)\n    procInputData <- reactive({predict(preProc, inputData())})\n    msg <- \"Data has been transformed!\"\n  })\n  \n  output$preProcMsg <- renderText({\n    preProcessEventMsg()\n  })\n}\n\nshinyApp(ui, server)",
    "created" : 1459749411755.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "89|25|98|2|\n100|37|102|2|\n104|34|106|2|\n108|37|110|2|\n112|37|120|2|\n122|31|130|2|\n132|37|153|2|\n155|43|165|2|\n167|46|177|2|\n179|35|182|2|\n184|34|190|2|\n192|39|195|2|\n197|60|201|2|\n203|35|205|2|\n",
    "hash" : "3585777634",
    "id" : "6379B808",
    "lastKnownWriteTime" : 1459934504,
    "last_content_update" : 1459935364089,
    "path" : "~/workspace/R/projects/ShinyDashboardExample/app.R",
    "project_path" : "app.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}